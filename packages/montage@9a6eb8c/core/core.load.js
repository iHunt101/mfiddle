montageDefine("9a6eb8c","core/core",{dependencies:["collections/shim","./shim/object","./shim/array","./shim/string","./extras/object","./extras/date","./extras/element","./extras/function","./extras/regexp","./extras/string","./deprecate","./uuid","collections/listen/property-changes","frb","collections/weak-map","collections/map","frb/parse","frb/evaluate","frb/assign","frb/observe","frb/bind","frb/compile-observer","frb/scope","frb/observers","./serialization/bindings","./promise"],factory:function(e,t){function n(e,t){var i=o+t+r;return e.hasOwnProperty(i)?e[i]:Object.defineProperty(e,i,{enumerable:!1,configurable:!1,writable:!0,value:Object.create(n(Object.getPrototypeOf(e),t))})[i]}e("collections/shim"),e("./shim/object"),e("./shim/array"),e("./shim/string"),e("./extras/object"),e("./extras/date"),e("./extras/element"),e("./extras/function"),e("./extras/regexp"),e("./extras/string");var i=e("./deprecate"),r="AttributeProperties",o="_",a="__proto__",s="value",l="enumerable",u="distinct",c="serializable",h=Array.prototype,d=Object.prototype,f=!0,p=t.Montage=function p(){};p.deprecate=i.deprecateMethod(p,i.deprecateMethod,"Montage.deprecate","deprecate module's deprecateMethod"),p.callDeprecatedFunction=i.deprecateMethod(p,i.callDeprecatedFunction,"Montage.callDeprecatedFunction","deprecate module's callDeprecatedFunction");var m={}.__proto__===Object.prototype,v={_montage_metadata:1,__state__:1},g=Object.getOwnPropertyNames(Function);if(Object.defineProperty(p,"specialize",{value:function(e,t){var n,r,o,a,s,l,u,c=this,h=this.specialize===void 0;if(e=e||Object.empty,t=t||Object.empty,n=e.constructor&&e.constructor.value?e.constructor.value:e.didCreate&&e.didCreate.value?p.deprecate(null,e.didCreate.value,"didCreate","constructor"):function(){return this.superForValue("constructor")()||this},m)n.__proto__=c;else{o=Object.getOwnPropertyNames(c);for(var l=0;o.length>l;l++)a=o[l],v.hasOwnProperty(a)||(s=Object.getOwnPropertyDescriptor(n,a),(!s||s.configurable)&&p.defineProperty(n,a,Object.getOwnPropertyDescriptor(c,a)));n.__constructorProto__=c,p.defineProperty(n,"isPrototypeOf",{value:function(e){for(;null!==e;){if(Object.getPrototypeOf(e)===this)return!0;e=Object.getPrototypeOf(e)}return!1},enumerable:!1})}if(r=Object.create(this.prototype),h){for(o=Object.getOwnPropertyNames(p),l=0;o.length>l;l++)a=o[l],s=Object.getOwnPropertyDescriptor(n,a),(!s||s.configurable)&&p.defineProperty(n,a,Object.getOwnPropertyDescriptor(p,a));for(o=Object.getOwnPropertyNames(p.prototype),l=0;o.length>l;l++)a=o[l],s=Object.getOwnPropertyDescriptor(n,a),(!s||s.configurable)&&p.defineProperty(r,a,Object.getOwnPropertyDescriptor(p.prototype,a))}if(p.defineProperties(r,e),f){u=function(e,t,n){function r(){return this===t&&i.deprecationWarning(p.getInfoForObject(t).objectName+"."+n+" should be moved to constructorProperties",null,3),e.apply(this,arguments)}return r.deprecatedFunction=e,r};for(a in e)g.has(a)?delete e[a]:(s=e[a],s.value&&"function"==typeof s.value&&!s.value.__isConstructor__?s.value=u(s.value,n,a):(s.get&&(s.get=u(s.get,n,a)),s.set&&(s.set=u(s.set,n,a))));p.defineProperties(n,e),p.defineProperty(n,"create",{value:function(){return new n},enumerable:!1})}return p.defineProperties(n,t),p.defineProperty(n,"__isConstructor__",{value:!0,enumerable:!1}),p.defineProperty(n,"_superCache",{value:{},enumerable:!1}),n.prototype=r,p.defineProperty(r,"constructor",{value:n,enumerable:!1}),n},writable:!0,configurable:!0,enumerable:!1}),!m){var y=Object.getPrototypeOf;Object.getPrototypeOf=function(e){return"function"==typeof e&&e.__constructorProto__?e.__constructorProto__:y.apply(Object,arguments)}}Object.defineProperty(p,"create",{configurable:!0,value:function(e,t){if(void 0!==e&&"object"!=typeof e&&"function"!=typeof e)throw new TypeError("Object prototype may only be an Object or null, not '"+e+"'");if(e=e===void 0?this:e,"function"==typeof e)return t?e.specialize(t):new e;var n=Object.create(e);return t&&p.defineProperties(n,t),n}});var _=[c];_.forEach(function(e){Object.defineProperty(Object.prototype,o+e+r,{enumerable:!1,configurable:!1,writable:!0,value:{}})}),Object.defineProperty(p,"defineProperty",{value:function(e,t,i){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object must be an object, not '"+e+"'");var r=s in i;if(u in i&&!r)throw new TypeError("Cannot use distinct attribute on non-value property '"+t+"'");if(a in i)i.__proto__=r?"function"==typeof i.value?M:w:b;else{var f;f=r?"function"==typeof i.value?M:w:b;for(var p in f)p in i||(i[p]=f[p])}if(i.hasOwnProperty(l)||t.charAt(0)!==o||(i.enumerable=!1),i.hasOwnProperty(c)||(i.enumerable?i.get&&!i.set?i.serializable=!1:i.writable===!1&&(i.serializable=!1):i.serializable=!1),c in i&&(n(e,c)[t]=i.serializable),i.distinct!==!0||"object"!=typeof i.value){var m,v,g;if(e._superDependencies){if("function"==typeof i.value&&(m=e._superDependencies[t+".value"]))for(v=0,g=m.length;g>v;v++)delete m[v]._superCache[t+".value"];if("function"==typeof i.get&&(m=e._superDependencies[t+".get"]))for(v=0,g=m.length;g>v;v++)delete m[v]._superCache[t+".get"];if("function"==typeof i.set&&(m=e._superDependencies[t+".set"]))for(v=0,g=m.length;g>v;v++)delete m[v]._superCache[t+".set"]}return Object.defineProperty(e,t,i)}(function(e,t,n,i){var r=function(e,t,n){Object.defineProperty(e,t,{enumerable:!1,configurable:!0,writable:!0,value:n})};n.constructor===Object&&Object.getPrototypeOf(n)===d?0!==Object.keys(n).length?Object.defineProperty(i,e,{configurable:!0,get:function(){var e=this[t];if(!e){var i;e={};for(i in n)e[i]=n[i];this.hasOwnProperty(t)?this[t]=e:r(this,t,e)}return e},set:function(e){this.hasOwnProperty(t)?this[t]=e:r(this,t,e)}}):Object.defineProperty(i,e,{configurable:!0,get:function(){var e=this[t];return e||(e={},this.hasOwnProperty(t)?this[t]=e:r(this,t,e)),e},set:function(e){this.hasOwnProperty(t)?this[t]=e:r(this,t,e)}}):(n.__proto__||Object.getPrototypeOf(n))===h?0!==n.length?Object.defineProperty(i,e,{configurable:!0,get:function(){var e=this[t];if(!e){var i,o;for(e=[],i=0;(o=n[i])!==void 0;i++)e[i]=o;this.hasOwnProperty(t)?this[t]=e:r(this,t,e)}return e},set:function(e){this.hasOwnProperty(t)?this[t]=e:r(this,t,e)}}):Object.defineProperty(i,e,{configurable:!0,get:function(){var e=this[t];return e||(e=[],this.hasOwnProperty(t)?this[t]=e:r(this,t,e)),e},set:function(e){this.hasOwnProperty(t)?this[t]=e:r(this,t,e)}}):n.constructor.prototype===Object.getPrototypeOf(n)?Object.defineProperty(i,e,{configurable:!0,get:function(){var e=this[t];if(!e){var i;e=new n.constructor;for(i in n)e[i]=n[i];this.hasOwnProperty(t)?this[t]=e:r(this,t,e)}return e},set:function(e){this.hasOwnProperty(t)?this[t]=e:r(this,t,e)}}):Object.defineProperty(i,e,{configurable:!0,get:function(){var e=this[t];return e||(e=Object.create(n.__proto__||Object.getPrototypeOf(n)),this.hasOwnProperty(t)?this[t]=e:r(this,t,e)),e},set:function(e){this.hasOwnProperty(t)?this[t]=e:r(this,t,e)}})})(t,o+t,i.value,e)}}),Object.defineProperty(p,"defineProperties",{value:function(e,t){if("object"!=typeof t||null===t)throw new TypeError("Properties must be an object, not '"+t+"'");for(var n in t)"_bindingDescriptors"!==n&&this.defineProperty(e,n,t[n]);return e}});var b={enumerable:!0,configurable:!0,serializable:!0},w={writable:!0,enumerable:!0,configurable:!0,serializable:"reference"},M={writable:!0,enumerable:!1,configurable:!0,serializable:!1};p.defineProperty(p,"didCreate",{value:Function.noop});var C=function(e,t){var n,i,r,o,a,s,l,u,c;if(!t._superPropertyName||!t._superPropertyType)for(p.defineProperty(t,"_superPropertyType",{value:null}),p.defineProperty(t,"_superPropertyName",{value:null}),l=e;!u&&null!==l;){for(n=Object.getOwnPropertyNames(l),i=Object.getPrototypeOf(l),r=0,o=n.length,r;o>r;r++){if(a=n[r],c=Object.getOwnPropertyDescriptor(l,a),null!=(s=c.value)&&(s===t||s.deprecatedFunction===t)){t._superPropertyType="value",t._superPropertyName=a,u=!0;break}if(null!=(s=c.get)&&(s===t||s.deprecatedFunction===t)){t._superPropertyType="get",t._superPropertyName=a,u=!0;break}if(null!=(s=c.set)&&(s===t||s.deprecatedFunction===t)){t._superPropertyType="set",t._superPropertyName=a,u=!0;break}}l=i}return T(e,t._superPropertyType,t._superPropertyName)},x=function(){if("function"!=typeof x.caller)throw new TypeError("Can't get super without caller. Use this.superForValue(methodName) if using strict mode.");var e=C(this,x.caller);return"function"==typeof e?e.bind(this):Function.noop},T=function(e,t,n){var i,r,o,a,s,l=e,u=n+"."+t;if(e._superContext||p.defineProperty(e,"_superContext",{value:{}}),e._superContext[u])l=e._superContext[u];else for(l=e;null!==l&&(!l.hasOwnProperty(n)||(o=Object.getOwnPropertyDescriptor(l,n),"function"!=typeof o[t]));)l=Object.getPrototypeOf(l);if(a=l.constructor,a._superCache&&a._superCache[u])return s=function(e,t,n,i){return function(){t._superContext[e]=n;var r=i.apply(t,arguments);return delete t._superContext[e],r}}(u,e,a._superCache[u].owner,a._superCache[u].func);for(r=l;i===void 0&&(r=Object.getPrototypeOf(r));)if(r._superDependencies||p.defineProperty(r,"_superDependencies",{value:{}}),r._superDependencies[u]||(r._superDependencies[u]=[]),r._superDependencies[u].push(a),o=Object.getOwnPropertyDescriptor(r,n)){if("function"==typeof o[t]){i=o[t];break}break}return"function"==typeof i?(s=function(e,t,n,i){return function(){t._superContext[e]=n;var r=i.apply(t,arguments);return delete t._superContext[e],r}}(u,e,r,i),a._superCache||p.defineProperty(a,"_superCache",{value:{}}),a._superCache[u]={func:i,owner:r},s):Function.noop},S=function(e){return T(this,"value",e)},E=function(e){return T(this,"get",e)},P=function(e){return T(this,"set",e)};p.defineProperty(p,"super",{get:x,enumerable:!1}),p.defineProperty(p.prototype,"super",{get:x,enumerable:!1}),p.defineProperty(p,"superForValue",{value:S,enumerable:!1}),p.defineProperty(p.prototype,"superForValue",{value:S,enumerable:!1}),p.defineProperty(p,"superForGet",{value:E,enumerable:!1}),p.defineProperty(p.prototype,"superForGet",{value:E,enumerable:!1}),p.defineProperty(p,"superForSet",{value:P,enumerable:!1}),p.defineProperty(p.prototype,"superForSet",{value:P,enumerable:!1}),p.defineProperty(p,"getSerializablePropertyNames",{value:function(e){var t=[],n=e._serializableAttributeProperties;if(n)for(var i in n)n[i]&&t.push(i);return t}}),p.defineProperty(p,"getPropertyAttribute",{value:function(e,t,n){var i=o+n+r,a=e[i];return a?a[t]:void 0}}),p.defineProperty(p,"getPropertyAttributes",{value:function(e,t){var n={},i=o+t+r,a=e[i];if(a){for(var s in a)n[s]=a[s];return n}}});var k={isInstance:{value:!0}},D={objectName:{value:"Function"},isInstance:{value:!0}};p.defineProperty(p,"getInfoForObject",{value:function(e){var t,n;if(z.call(e,"_montage_metadata"))return e._montage_metadata;if(t=e._montage_metadata||e.constructor&&e.constructor._montage_metadata||null,n=e.constructor===Function?D:k,e===Object.prototype)return Object.create(t,n);try{return Object.defineProperty(e,"_montage_metadata",{enumerable:!1,writable:!0,value:Object.create(t,n)})._montage_metadata}catch(i){return e._montage_metadata=Object.create(t,n)}}});var O=e("./uuid");"undefined"!=typeof window&&(window.uuid=O.generate());var z=Object.prototype.hasOwnProperty,L=function(){var e=O.generate(),t=p.getInfoForObject(this);try{null!==t&&t.isInstance===!1?(this._uuid=e,Object.defineProperty(this,"uuid",{get:function(){return this.hasOwnProperty("uuid")?this._uuid:L.call(this)}})):(t.isInstance&&Object.defineProperty(this,"uuid",{configurable:!0,enumerable:!1,writable:!1,value:e}),!(this instanceof Element)&&t.isInstance&&s in(Object.getOwnPropertyDescriptor(this,"uuid")||{})&&a in this||(this._uuid=e))}catch(n){}return this._uuid=e,e},A=function A(){return z.call(this,"_uuid")?this._uuid:L.call(this)};Object.defineProperty(Object.prototype,"_uuid",{enumerable:!1,value:null,writable:!0}),Object.defineProperty(Object.prototype,"uuid",{configurable:!0,get:A,set:function(){}}),p.defineProperty(p,"identifier",{value:null,serializable:!0}),p.defineProperty(p.prototype,"identifier",{value:null,serializable:!0}),p.defineProperty(p.prototype,"equals",{value:function(e){return e?this===e||this.uuid===e.uuid:!1}}),p.defineProperty(p,"equals",{value:p.prototype.equals}),p.defineProperty(p.prototype,"callDelegateMethod",{value:function(e){var t,n,i=this.delegate;return"string"==typeof this.identifier&&(t=this.identifier+e.toCapitalized(),i&&"function"==typeof(n=i[t]))?(h.shift.call(arguments),n.apply(i,arguments)):i&&"function"==typeof(n=i[e])?(h.shift.call(arguments),n.apply(i,arguments)):void 0}});var N=e("collections/listen/property-changes");Object.addEach(p,N.prototype),Object.addEach(p.prototype,N.prototype);var I=t.Bindings=e("frb"),j={defineBinding:{value:function(e,t,n){return I.defineBinding(this,e,t,n)}},defineBindings:{value:function(e,t){return I.defineBindings(this,e,t)}},cancelBinding:{value:function(e){return I.cancelBinding(this,e)}},cancelBindings:{value:function(){return I.cancelBindings(this)}},getBinding:{value:function(e){return I.getBinding(this,e)}},getBindings:{value:function(){return I.getBindings(this)}}};p.defineProperties(p,j),p.defineProperties(p.prototype,j);var Y=e("collections/weak-map"),F=e("collections/map"),R=e("frb/parse"),H=e("frb/evaluate"),W=e("frb/assign");e("frb/observe"),e("frb/bind");var X=e("frb/compile-observer"),B=e("frb/scope"),U=e("frb/observers"),q=U.autoCancelPrevious,V=new Y,K={getPath:{value:function(e,t,n,i){return H(e,this,t||this,n,i)}},setPath:{value:function(e,t,n,i,r){return W(this,e,t,n||this,i,r)}},observePath:{value:function(e,t){var n=R(e),i=X(n);return i(q(t),new B(this))}},addRangeAtPathChangeListener:{value:function(e,t,n,i,r,o){function a(e,i,r){if(t[n])t[n](e,i,r);else{if(!t.call)throw Error("Can't dispatch range change to "+t);t.call(null,e,i,r)}}n=n||"handleRangeChange";var s=[];return this.addPathChangeListener(e,function(e){return e&&e.toArray&&e.addRangeChangeListener?(a(e.toArray(),s.toArray(),0),s=e,e.addRangeChangeListener(a)):(e=[],a(e,s,0),s=e,void 0)},void 0,void 0,i,r,o)}},getPathChangeDescriptors:{value:function(){return V.has(this)||V.set(this,{}),V.get(this)}},getPathChangeDescriptor:{value:function(e,t,n){var i=p.getPathChangeDescriptors.call(this);return Object.owns(i,e)||(i[e]={willChangeListeners:new F,changeListeners:new F}),i=i[e],i=n?i.willChangeListeners:i.changeListeners,i.has(t)||i.set(t,{path:e,handler:t,beforeChange:n,cancel:Function.noop}),i.get(t)}},addPathChangeListener:{value:function(e,t,n,i,r,o,a){var s=this;t=t||Function.noop;var l=p.getPathChangeDescriptor.call(this,e,t,i);l.cancel();var u,c,h,d=R(e);if(t===Function.noop)h=function(t){if(c)throw Error("Path change handler needs a handler because it emits new values when the source changes: "+JSON.stringify(e));c=!0,u=t};else if(n)h=function(i){return t[n].call(t,i,e,s)};else if(t.handlePathChange)h=function(n){return t.handlePathChange.call(t,n,e,s)};else{if("function"!=typeof t)throw Error("Can't recognize handler type: "+t+". Must be function or delegate implementing handlePathChange.");h=function(n){return t.call(s,n,e,s)}}var f=X(d),m=new B(this);m.beforeChange=i,m.parameters=r,m.document=o,m.components=a;var v=f(q(h),m);return l.cancel=v,c?u:v}},removePathChangeListener:{value:function(e,t,n){t=t||Function.noop;var i=p.getPathChangeDescriptors.call(this),r=n?"willChangeListeners":"changeListeners";if(!Object.owns(i,e))throw Error("Can't find "+r+" for "+JSON.stringify(e));var o=i[e],a=o[r];if(!a.has(t))throw Error("Can't find "+r+" for "+JSON.stringify(e));var s=a.get(t);s.cancel(),a["delete"](t),0===o.willChangeListeners.length&&0===o.changeListeners.length&&delete i[e];for(var l in i)return;V["delete"](this)}},addBeforePathChangeListener:{value:function(e,t,n,i,r,o){return p.addPathChangeListener.call(this,e,t,n,!0,i,r,o)}},removeBeforePathChangeListener:{value:function(e,t){return p.removePathChangeListener.call(this,e,t,!0)}}};p.defineProperties(p,K),p.defineProperties(p.prototype,K),e("./serialization/bindings"),t._blueprintModuleIdDescriptor={serializable:!1,enumerable:!1,get:function(){var e=p.getInfoForObject(this),t=e&&!e.isInstance?this:this.constructor;if(!Object.getOwnPropertyDescriptor(t,"_blueprintModuleId")||!t._blueprintModuleId){e=p.getInfoForObject(t);var n=e.moduleId,i=n.lastIndexOf("/"),r=n.lastIndexOf(".");i=-1===i?0:i+1,r=-1===r?n.length:r,r=i>r?n.length:r,p.defineProperty(t,"_blueprintModuleId",{enumerable:!1,value:n.slice(0,r)+".meta"})}return t._blueprintModuleId}},t._blueprintDescriptor={serializable:!1,enumerable:!1,get:function(){var n=p.getInfoForObject(this),i=n&&!n.isInstance?this:this.constructor;if(!Object.getOwnPropertyDescriptor(i,"_blueprint")||!i._blueprint){var r=i.blueprintModuleId;if(""===r)throw new TypeError("Blueprint moduleId undefined for the module '"+JSON.stringify(i)+"'");t._blueprintDescriptor.BlueprintModulePromise||(t._blueprintDescriptor.BlueprintModulePromise=e.async("core/meta/module-blueprint").get("ModuleBlueprint")),p.defineProperty(i,"_blueprint",{enumerable:!1,value:t._blueprintDescriptor.BlueprintModulePromise.then(function(e){var t=p.getInfoForObject(i);return e.getBlueprintWithModuleId(r,t.require).fail(function(t){if(-1!==t.message.indexOf("Can't XHR"))return e.createDefaultBlueprintForObject(i).then(function(e){return e});throw t})})})}return i._blueprint},set:function(t){var n,i=p.getInfoForObject(this),r=i&&!i.isInstance?this:this.constructor;if(null===t)n=null;else{if("function"==typeof t.then)throw new TypeError("Object blueprint should not be a promise");t.blueprintInstanceModule=r.blueprintModule,n=e("./promise").Promise.resolve(t)}p.defineProperty(r,"_blueprint",{enumerable:!1,value:n})}}}});